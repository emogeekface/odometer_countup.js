"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Odometer=void 0;class Odometer{constructor(e){this.defaults={duration:.8,delay:.25},this.cell_digits=null,this.options=Object.assign(Object.assign({},this.defaults),e),this.cell_digits=null}render(e,t){var n,i=!1;this.cell_digits||(i=!0,document.querySelector("style[odometer]")||((n=document.createElement("style")).setAttribute("odometer","odometer"),n.innerHTML=".odometer-numbers{display:inline-flex;line-height:100%;overflow-y:hidden}.odometer-numbers>span{display:flex;flex-direction:column;justify-content:start;align-items:center;height:1em;will-change:transform;transform:translateY(0)}",document.head.appendChild(n)),e.innerHTML='<div class="odometer-numbers"></div>',this.cell_digits=[]);const o='<span style="color:transparent">0</span>',r=`transform ${this.options.duration}s ease-out`;for(var s=this.cell_digits.length;s<t.length;s++){var l=document.createElement("span");l.style.transition=r,l.innerHTML=i?"":o,e.firstChild&&e.firstChild.appendChild(l),this.cell_digits.push({container:l,current:void 0,position:i?1:0,new:!0})}function a(e,t){e.position--,e.container.appendChild(t),e.lastTimeAdd=+new Date,e.new?(e.new=!1,requestAnimationFrame(function(){e.container.style.transform=`translateY(${e.position}em)`})):e.container.style.transform=`translateY(${e.position}em)`}for(var d=Math.max(t.length,this.cell_digits.length),s=0;s<d;s++){var c,m=s<t.length?t.charAt(s):null;const u=this.cell_digits[s];u.current!=m&&(u.current=m,(c=document.createElement("span")).innerHTML=null===m?o:m,(u.container.children.length<4?a:function(e,t){e.nextToAdd&&(a(e,e.nextToAdd),clearTimeout(e.lastTimer),e.nextToAdd=null);var n=+new Date,i=1e3*this.options.delay-(n-e.lastTimeAdd);this.options.delay<=0||n-e.lastTimeAdd>=1.05*i?(a(e,t),e.nextToAdd=null):(e.nextToAdd=t,e.lastTimer=setTimeout(()=>{a(e,e.nextToAdd),e.nextToAdd=null},1e3*this.options.duration))})(u,c),clearTimeout(u.timerClean),u.timerClean=setTimeout(function(){u.timerClean=null,u.container.children.length<3||(u.container.style.transition="none",requestAnimationFrame(()=>{for(u.position=-1;1<u.container.children.length;)u.container.removeChild(u.container.firstChild);var e=document.createElement("span");e.innerHTML=o,u.container.insertBefore(e,u.container.firstChild),u.container.style.transform=`translateY(${u.position}em)`,requestAnimationFrame(()=>{u.container.style.transition=r})}))},1e3*((this.options.duration||.8)+(this.options.duration||.25))+2500))}}}exports.Odometer=Odometer;